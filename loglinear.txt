# -*- coding: utf-8 -*-
"""log linear model.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Ud4UMAm64aL1pfxegTtDG8qPt5kmmhlx
"""

library(ggplot2)

data(mtcars)

head(mtcars)

log_linear_model <- glm(log(mpg) ~ wt, data = mtcars)

new_data <- data.frame(wt = seq(min(mtcars$wt), max(mtcars$wt), length.out = 100))

new_data$log_mpg <- predict(log_linear_model, newdata = new_data)
new_data$mpg <- exp(new_data$log_mpg)

ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point() +
  geom_line(data = new_data, aes(x = wt, y = mpg), color = 'blue') +
  labs(title = "Log Linear model of WT vs MPG", x = "Weight", y = "Miles per gallon") +
  theme_minimal()

"""gaussian log linear model"""

# for gaussian log model - predictors wt + hp
gaussian_model <- glm(mpg ~ wt + hp, data = mtcars, family = gaussian(link = 'log'))
poisson_model <- glm(mpg ~ wt + hp, data = mtcars, family = poisson(link='log'))

summary(gaussian_model)
summary(poisson_model)

# build the prediction data

gaussian_data <- expand.grid(
  wt = seq(min(mtcars$wt), max(mtcars$wt), length.out = 100),
  hp = quantile(mtcars$hp, probs=c(0.25, 0.5, 0.75))
)

# now predict
gaussian_data$pred <- predict(gaussian_model, newdata = gaussian_data, type = 'response')

# visualize
ggplot() + geom_point(data = mtcars, aes(x = wt, y = mpg)) + geom_line(data = gaussian_data, aes(x = wt, y=pred, color = factor(hp))) +
  labs(title = "Gaussian Model Plot", x = "WT + HP", y = "MPG") + theme_minimal()

# build prediction data
poisson_data <- expand.grid(
  wt = seq(min(mtcars$wt), max(mtcars$wt), length.out = 100),
  hp = quantile(mtcars$hp, probs=c(0.25, 0.5, 0.75))
)

# now predict
poisson_data$pred <- predict(poisson_model, newdata = poisson_data, type = 'response')

# visualize
ggplot() + geom_point(data = mtcars, aes(x = wt, y = mpg)) + geom_line(data = poisson_data, aes(x = wt, y=pred, color = factor(hp))) +
  labs(title = "Poisson Model Plot", x = "WT + HP", y = "MPG") + theme_minimal()

# Model comparison
cat("\nModel Comparison (AIC):\n")
cat("Gaussian model AIC:", AIC(model_gaussian), "\n")
cat("Poisson model AIC:", AIC(model_poisson), "\n")